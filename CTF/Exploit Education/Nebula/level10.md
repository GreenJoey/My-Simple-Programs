# Guide to Nebula Level 10


## Level Info
The setuid binary at **/home/flag10/flag10** binary will upload any file given, as long as it meets the requirements of the _access()_ system call.

To do this level, log in as the **level10** account with the password **level10**. Files for this level can be found in /home/flag10.


## Solution
This level introduced us to the family of Race Condition Exploits. We are given a binary that checks if the user **level10** has read access to a given file, and it does, reads it and sends it via socket.

The first thing we need to do is start a infinite that would keep calling `nc -l 18211`. We need this because the binary connects at port 18211 and also Debian's netcat implementation has undocumented and unreliable "-k" flag, which keeps the listner open.

We need to keep in mind the fact the binary run with effective UID of user **flag10**, who has the permission to read the token file and the only protection against reading the file is the `access()` which checks the permission of the real UID to read the file. Once we bypass the `access()` with a file that user **level10** has access to, we can read the token file and send it via socket.

To do this we run two shell scripts, _level10.exploit1.sh_ runs a infinite loop that creates a dummy file and passes it argument to the binary, while _level10.exploit2.sh_ runs a infinite loop that creates a symbolic link to the token file with the same name as dummy file. We run both the shell scripts simultaneously, and onc in a while the second shell script will be able to execute between the `access()` and `read()` calls, and when it does the binary reads the token file and sends it to the listener running
