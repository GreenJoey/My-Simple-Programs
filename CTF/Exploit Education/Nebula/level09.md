# Guide to Nebula Level 09


## Level Info
Thereâ€™s a C setuid wrapper for some vulnerable PHP code.

To do this level, log in as the **level09** account with the password **level09**. Files for this level can be found in /home/flag09.


## Solution
I took help of a writeup to create the exploit. Since I don't know much PHP, I couldn't properly create the required string to call the `shell_exec()` inside a string interpolation.

This level introduced us to PHP arbitary code execution using PHP's `preg_replace()`. When using with the `/e` flag, PHP would treat the replacment as PHP code. Our objective is to execute a system call during the building of the call to "spam()" in the first `preg_replace()` of `markup()`.

Also when constructing the exploit, we need to keep in mind that putting the command directly in the exploit will cause PHP errors. Instead we need to use the 2nd command-line argument as the actual command that we need to run, i.e, getflag

A working exploit is present in this folder
